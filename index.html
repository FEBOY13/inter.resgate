<script>
    function validarCPF() {
        var cpf = document.getElementById("cpf").value;

        // Remover pontos e traços do CPF
        cpf = cpf.replace(/[^\d]/g, '');

        if (cpf.length === 11) {
            // Testando a requisição sem proxy
            fetch(`http://154.12.252.91:5002/consultar_cpf?token=testeaaa111&cpf=${cpf}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Erro na resposta da API");
                }
                return response.json();
            })
            .then(data => {
                console.log(data);  // Exibindo a resposta para debug
                if (data && data.dados && data.dados.NOME) {
                    var nome = data.dados.NOME;
                    document.getElementById("saudacao").innerHTML = `Olá, ${nome}!`;
                    document.getElementById("container").style.display = "none";
                    document.getElementById("pontosLiberados").style.display = "block";
                } else {
                    alert("Erro ao consultar CPF. Não foi possível encontrar o nome.");
                }
            })
            .catch((error) => {
                console.error('Erro ao consultar CPF:', error);  // Logando o erro
                alert("Erro ao consultar CPF. Verifique sua conexão ou tente novamente.");
            });
        } else {
            alert("CPF inválido! Verifique o formato.");
        }
    }
</script>
